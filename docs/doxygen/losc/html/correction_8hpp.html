<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Localized Orbital Scaling Correction (LOSC) C++ library: /home/yuncai/Documents/Server/losc/include/losc/correction.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Localized Orbital Scaling Correction (LOSC) C++ library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li><a href="annotated.html"><span>Class</span></a></li>
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('correction_8hpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">correction.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>C++ interface for the correction from LOSC.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="eigen__def_8hpp_source.html">losc/eigen_def.hpp</a>&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
</div>
<p><a href="correction_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a70cacaeb1a24172447dac12d6bf902be"><td class="memItemLeft" align="right" valign="top">LOSCMatrix&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correction_8hpp.html#a70cacaeb1a24172447dac12d6bf902be">losc::ao_hamiltonian_correction</a> (ConstRefMat &amp;S, ConstRefMat &amp;C_lo, ConstRefMat &amp;Curvature, ConstRefMat &amp;LocalOcc)</td></tr>
<tr class="memdesc:a70cacaeb1a24172447dac12d6bf902be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate LOSC effective Hamiltonian under AO basis.  <a href="correction_8hpp.html#a70cacaeb1a24172447dac12d6bf902be">More...</a><br /></td></tr>
<tr class="separator:a70cacaeb1a24172447dac12d6bf902be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec1318ccac401d8a4da9f06874d390ad"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correction_8hpp.html#aec1318ccac401d8a4da9f06874d390ad">losc::energy_correction</a> (ConstRefMat &amp;Curvature, ConstRefMat &amp;LocalOcc)</td></tr>
<tr class="memdesc:aec1318ccac401d8a4da9f06874d390ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the total energy correction from LOSC.  <a href="correction_8hpp.html#aec1318ccac401d8a4da9f06874d390ad">More...</a><br /></td></tr>
<tr class="separator:aec1318ccac401d8a4da9f06874d390ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41ad43c2da822b197aac0e52adbe17e"><td class="memItemLeft" align="right" valign="top">vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correction_8hpp.html#aa41ad43c2da822b197aac0e52adbe17e">losc::orbital_energy_post_scf</a> (ConstRefMat &amp;H_dfa, ConstRefMat &amp;H_losc, ConstRefMat &amp;C_co)</td></tr>
<tr class="memdesc:aa41ad43c2da822b197aac0e52adbe17e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate corrected orbital energy from LOSC in a post-SCF approach.  <a href="correction_8hpp.html#aa41ad43c2da822b197aac0e52adbe17e">More...</a><br /></td></tr>
<tr class="separator:aa41ad43c2da822b197aac0e52adbe17e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cfadfd785ed6fa231612c73f6bacbd1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correction_8hpp.html#a2cfadfd785ed6fa231612c73f6bacbd1">losc::C_API_ao_hamiltonian_correction</a> (ConstRefMat &amp;S, ConstRefMat &amp;C_lo, ConstRefMat &amp;Curvature, ConstRefMat &amp;LocalOcc, RefMat H_losc)</td></tr>
<tr class="memdesc:a2cfadfd785ed6fa231612c73f6bacbd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The C interface to calculate LOSC effective Hamiltonian under AOs.  <a href="correction_8hpp.html#a2cfadfd785ed6fa231612c73f6bacbd1">More...</a><br /></td></tr>
<tr class="separator:a2cfadfd785ed6fa231612c73f6bacbd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a067d28c3f79f24697c9a380b2d296de4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correction_8hpp.html#a067d28c3f79f24697c9a380b2d296de4">losc::C_API_orbital_energy_post_scf</a> (ConstRefMat &amp;H_dfa, ConstRefMat &amp;H_losc, ConstRefMat &amp;C_co, double *eig)</td></tr>
<tr class="memdesc:a067d28c3f79f24697c9a380b2d296de4"><td class="mdescLeft">&#160;</td><td class="mdescRight">C interface to calculate the corrected orbital energies from LOSC in a post-SCF approach.  <a href="correction_8hpp.html#a067d28c3f79f24697c9a380b2d296de4">More...</a><br /></td></tr>
<tr class="separator:a067d28c3f79f24697c9a380b2d296de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>C++ interface for the correction from LOSC. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="file_a70cacaeb1a24172447dac12d6bf902be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LOSCMatrix losc::ao_hamiltonian_correction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>C_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>Curvature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>LocalOcc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate LOSC effective Hamiltonian under AO basis. </p>
<p>The LOSC effective Hamiltonian is used for self-consistent LOSC (SCF-LOSC) calculations. This function constructs the LOSC effective Hamiltonian with fixed LOs. This LOSC effective Hamiltonian is used as an APPROXIMATION in the original LOSC paper (see <a href="https://doi.org/10.1093/nsr/nwx111">https://doi.org/10.1093/nsr/nwx111</a>). In addition, this LOSC effective Hamiltonian is used as the EXACT one in the developed version of the SCF-LOSC (see J. Phys. Chem. Lett. 2020, 11, 23, 10269-10277).</p>
<p>The expression of the LOSC effective Hamiltonian is shown as the Eq. S25 in the supporting information of the paper of original LOSC, and the Eq. 12 in the paper of the developed version.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>AOs overlap matrix with dimension of <code>[nbasis, nbasis]</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">C_lo</td><td>LOs coefficient matrix under AOs with dimension of <code>[nbasis, nlo]</code>. The <code>i</code>-th column in <code>C_lo</code> matrix is the <code>i</code>-th LO.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Curvature</td><td>LOSC curvature matrix with dimension of <code>[nlo, nlo]</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LocalOcc</td><td>LOSC local occupation matrix with dimension of <code>[nlo, nlo]</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the LOSC effective Hamiltonian with dimension of <code>[nbasis, nbasis]</code>.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classlosc_1_1LocalizerBase.html#aa77b14cd89d39693bdec64474a47eb47" title="Calculate the LOs&#39; coefficient matrix under AO. ">losc::LocalizerV2::lo()</a>: return the LOs coefficient matrix. </dd>
<dd>
<a class="el" href="classlosc_1_1CurvatureBase.html#aeb55a7843e84c47043e964599e3121c4" title="Compute the LOSC curvature matrix. ">losc::CurvatureBase::kappa()</a>: return the LOSC curvature matrix. </dd>
<dd>
<a class="el" href="local__occupation_8hpp.html#a2b32509da0db9e4dda89c09457708513" title="Calculate the local occupation matrix. ">losc::local_occupation()</a>: return the LOSC local occupation matrix. </dd></dl>

</div>
</div>
<a class="anchor" id="file_a2cfadfd785ed6fa231612c73f6bacbd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void losc::C_API_ao_hamiltonian_correction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>C_lo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>Curvature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>LocalOcc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a40f96aa28a459452c394e9b32eebdead">RefMat</a>&#160;</td>
          <td class="paramname"><em>H_losc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The C interface to calculate LOSC effective Hamiltonian under AOs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">S</td><td>AOs overlap matrix with dimension of <code>[nbasis, nbasis]</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">C_lo</td><td>LOs coefficient matrix under AOs with dimension of <code>[nbasis, nlo]</code>. The <code>i</code>-th column in <code>C_lo</code> matrix is the <code>i</code>-th LO.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Curvature</td><td>LOSC curvature matrix with dimension of <code>[nlo, nlo]</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LocalOcc</td><td>LOSC local occupation matrix with dimension of <code>[nlo, nlo]</code>. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">H_losc</td><td>a matrix with dimension of [nbasis, nbasis] at the input. At exit, it is updated to store the LOSC effective Hamiltonian.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classlosc_1_1LocalizerBase.html#aa77b14cd89d39693bdec64474a47eb47" title="Calculate the LOs&#39; coefficient matrix under AO. ">losc::LocalizerV2::lo()</a>: return the LOs coefficient matrix. </dd>
<dd>
<a class="el" href="classlosc_1_1CurvatureBase.html#aeb55a7843e84c47043e964599e3121c4" title="Compute the LOSC curvature matrix. ">losc::CurvatureBase::kappa()</a>: return the LOSC curvature matrix. </dd>
<dd>
<a class="el" href="local__occupation_8hpp.html#a2b32509da0db9e4dda89c09457708513" title="Calculate the local occupation matrix. ">losc::local_occupation()</a>: return the LOSC local occupation matrix. </dd>
<dd>
<a class="el" href="correction_8hpp.html#a70cacaeb1a24172447dac12d6bf902be" title="Calculate LOSC effective Hamiltonian under AO basis. ">losc::ao_hamiltonian_correction()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="file_a067d28c3f79f24697c9a380b2d296de4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void losc::C_API_orbital_energy_post_scf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>H_dfa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>H_losc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>C_co</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>eig</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>C interface to calculate the corrected orbital energies from LOSC in a post-SCF approach. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">H_dfa</td><td>The DFA Hamiltonian under AOs with dimension of <code>[nbasis, nbasis]</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">H_losc</td><td>The LOSC effective Hamiltonian under AOs with dimension of <code>[nbasis, nbasis]</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">C_co</td><td>The coefficient matrix of converged DFA COs under AOs with dimension of <code>[nbasis, n]</code> (<code>n &lt;= nbasis</code>, which is the number of COs). You can choose whatever number of COs you want. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">eig</td><td>a array with size of at least <code>n</code> (the number of input COs). At exit, the first <code>n</code> number of elements of <code>eig</code> are updated to be the LOSC-DFA orbital energies. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="correction_8hpp.html#aa41ad43c2da822b197aac0e52adbe17e" title="Calculate corrected orbital energy from LOSC in a post-SCF approach. ">losc::orbital_energy_post_scf()</a></dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function only calculates the orbital energies for the single spin associated with the input matrices. </dd>
<dd>
This function is just one of the ways to construct the LOSC corrected orbital energies in the post-SCF LOSC calculations. It is the way we used to produce results in the published paper for the post-SCF LOSC calculations. Besides this way, there are another two ways to calculate corrected orbital energies: (1) diagonalize the corrected LOSC-DFA Hamiltonian; (2) follow Eq. 11 of the original paper of LOSC to calculate the corrections to orbital energies. These three ways usually produce very similar results. </dd></dl>

</div>
</div>
<a class="anchor" id="file_aec1318ccac401d8a4da9f06874d390ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double losc::energy_correction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>Curvature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>LocalOcc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the total energy correction from LOSC. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Curvature</td><td>LOSC curvature matrix with dimension of <code>[nlo, nlo]</code>.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">LocalOcc</td><td>LOSC local occupation matrix with dimension of <code>[nlo, nlo]</code>. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The total energy correction from LOSC. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classlosc_1_1CurvatureBase.html#aeb55a7843e84c47043e964599e3121c4" title="Compute the LOSC curvature matrix. ">losc::CurvatureBase::kappa()</a>: return the LOSC curvature matrix. </dd>
<dd>
<a class="el" href="local__occupation_8hpp.html#a2b32509da0db9e4dda89c09457708513" title="Calculate the local occupation matrix. ">losc::local_occupation()</a>: return the LOSC local occupation matrix. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is just the energy correction from LOSC, NOT the total energy of LOSC-DFA. Total energy of LOSC-DFA is <code>E_losc_dfa = E_dfa + E_losc</code>. </dd>
<dd>
This function only calculates the energy correction of the single spin associated with the input matrices. The total LOSC energy correction involves the contributions from both alpha and beta spins. Thus, you may need to call this function twice (for unrestricted KS calculation definitely). </dd></dl>

</div>
</div>
<a class="anchor" id="file_aa41ad43c2da822b197aac0e52adbe17e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;double&gt; losc::orbital_energy_post_scf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>H_dfa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>H_losc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="eigen__def_8hpp.html#a6d6bb030582607dca15153e77d2d8a31">ConstRefMat</a> &amp;&#160;</td>
          <td class="paramname"><em>C_co</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate corrected orbital energy from LOSC in a post-SCF approach. </p>
<p>This function gives the FINAL orbital energies. The corrections from LOSC are applied at the return. This is the difference to the <a class="el" href="correction_8hpp.html#aec1318ccac401d8a4da9f06874d390ad" title="Calculate the total energy correction from LOSC. ">losc::energy_correction()</a>.</p>
<p>The corrected orbital energies are defined as the expectation values of converged DFA COs on the LOSC-DFA Hamiltonian, that is, \( \epsilon_i = \langle \psi_i | H_{\rm{dfa}} + H_{\rm{losc}} | \psi_i \rangle. \)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">H_dfa</td><td>The DFA Hamiltonian under AOs with dimension of <code>[nbasis, nbasis]</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">H_losc</td><td>The LOSC effective Hamiltonian under AOs with dimension of <code>[nbasis, nbasis]</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">C_co</td><td>The coefficient matrix of converged DFA COs under AOs with dimension of <code>[nbasis, n]</code> (<code>n &lt;= nbasis</code>, which is the number of COs). You can choose whatever number of COs you want.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A vector of the corrected orbital energies from LOSC with size of <code>n</code>. The order of orbital energies matches the order of the input COs coefficient matrix (the order of columns in <code>C_co</code> matrix). </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="correction_8hpp.html#a70cacaeb1a24172447dac12d6bf902be" title="Calculate LOSC effective Hamiltonian under AO basis. ">losc::ao_hamiltonian_correction()</a>: return the LOSC effective Hamiltonian under AOs.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function only calculates the orbital energies for the single spin associated with the input matrices. </dd>
<dd>
This function is just one of the ways to construct the LOSC corrected orbital energies in the post-SCF LOSC calculations. It is the way we used to produce results in the published paper for the post-SCF LOSC calculations. Besides this way, there are another two ways to calculate corrected orbital energies: (1) diagonalize the corrected LOSC-DFA Hamiltonian; (2) follow Eq. 11 of the original paper of LOSC to calculate the corrections to orbital energies. These three ways usually produce very similar results. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_8c79f74d3aa840a401c3995537460e38.html">losc</a></li><li class="navelem"><a class="el" href="correction_8hpp.html">correction.hpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
